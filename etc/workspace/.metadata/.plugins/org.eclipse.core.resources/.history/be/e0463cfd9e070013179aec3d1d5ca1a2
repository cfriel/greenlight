package com.greenlight.integration;

import java.io.ByteArrayInputStream;
import java.io.InputStream;
import java.util.HashMap;

import org.apache.camel.Exchange;
import org.apache.camel.model.RoutesDefinition;

public class Feed {

    private Exchange exchange;

    public Feed(Exchange exchange) {
        this.exchange = exchange;
    }

    public void update(HashMap<String, Object> result) {

        try {

            String xml = (String)result.get("xml");

            InputStream is = new ByteArrayInputStream(xml.getBytes());

            RoutesDefinition routes = exchange.getContext().loadRoutesDefinition(is);

            exchange.getContext().addRouteDefinitions(routes.getRoutes());
        } catch (Exception ex) {

        }

    }

}
